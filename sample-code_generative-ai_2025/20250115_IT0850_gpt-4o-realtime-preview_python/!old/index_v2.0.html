<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>AIチャットインターフェース</title>
    <!-- integrity 属性を削除 -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js" crossorigin="anonymous"></script>
    <style>
        body { font-family: Arial, sans-serif; }
        #chat { 
            width: 80%; 
            max-width: 800px; 
            margin: 20px auto; 
            border: 1px solid #ccc; 
            padding: 10px; 
            height: 400px; 
            overflow-y: scroll; 
            background-color: #f9f9f9;
        }
        .message { 
            padding: 10px; 
            margin: 5px 0; 
            border-radius: 5px; 
        }
        .user { 
            background-color: #d1e7dd; 
            text-align: right; 
        }
        .ai { 
            background-color: #f8d7da; 
            text-align: left; 
        }
        #status { 
            width: 80%; 
            max-width: 800px; 
            margin: 10px auto; 
            font-size: 0.9em; 
            color: gray; 
            height: 100px; 
            overflow-y: scroll; 
            border: 1px solid #ccc; 
            padding: 5px; 
            background-color: #f1f1f1;
        }
    </style>
</head>
<body>
    <div id="chat"></div>
    <div id="status"></div>

    <script>
        const socket = io();

        socket.on('connect', () => {
            console.log('サーバーに接続しました。');
            // ユーザーの接続をチャットに表示
            const chat = document.getElementById('chat');
            const msgDiv = document.createElement('div');
            msgDiv.className = 'message user';
            msgDiv.textContent = 'ユーザーが接続しました。';
            chat.appendChild(msgDiv);
            chat.scrollTop = chat.scrollHeight;
        });

        socket.on('ai_message', (data) => {
            const chat = document.getElementById('chat');
            const msgDiv = document.createElement('div');
            msgDiv.className = 'message ai';
            msgDiv.textContent = data.message;
            chat.appendChild(msgDiv);
            chat.scrollTop = chat.scrollHeight;
        });

        socket.on('status_message', (data) => {
            const status = document.getElementById('status');
            const statusMsg = document.createElement('div');
            statusMsg.textContent = data.message;
            status.appendChild(statusMsg);
            status.scrollTop = status.scrollHeight;
        });

        // ユーザーからの音声入力が完了したら、ユーザーのメッセージをチャットに追加するロジックを追加することも可能です。
        // 現在はバックエンドからのメッセージのみを表示しています。
    </script>
</body>
</html>
